<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intesa Vincente</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --primary: #1a2a6c;
            --secondary: #b21f1f;
            --accent: #fdbb2d;
            --success: #2ecc71;
            --danger: #e74c3c;
            --info: #3498db;
            --dark: #0d1426;
            --light: #f8f9fa;
        }

        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
            min-height: 100vh;
            color: white;
            overflow: auto;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(13, 20, 38, 0.9);
            border-radius: 15px;
            border: 2px solid var(--accent);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        h1 {
            font-size: 2.2rem;
            color: var(--accent);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
            margin-bottom: 5px;
            font-weight: 800;
        }

        .subtitle {
            font-size: 1rem;
            color: var(--light);
            opacity: 0.9;
        }

        .game-layout {
            display: flex;
            gap: 15px;
            flex: 1;
            min-height: 500px;
        }

        .team-sidebar {
            flex: 0 0 220px;
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.1), rgba(26, 42, 108, 0.2));
            border-radius: 15px;
            padding: 15px;
            border: 2px solid rgba(253, 187, 45, 0.4);
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .team-sidebar.active {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.3), rgba(39, 174, 96, 0.2));
            border-color: var(--success);
            box-shadow: 0 0 25px rgba(46, 204, 113, 0.5);
            transform: translateY(-2px);
        }

        .team-name {
            font-size: 1.3rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            color: var(--accent);
            padding: 12px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            border: 2px solid var(--accent);
        }

        .team-sidebar.active .team-name {
            color: var(--success);
            border-color: var(--success);
        }

        .score {
            font-size: 2rem;
            font-weight: 800;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            border: 2px solid var(--accent);
            position: relative;
            overflow: hidden;
        }

        .team-sidebar.active .score {
            border-color: var(--success);
            color: var(--success);
        }

        .players-list {
            flex: 1;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-item {
            padding: 10px;
            margin: 6px 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 8px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-item:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08));
            transform: translateX(3px);
        }

        .game-center {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(13, 20, 38, 0.9);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--accent);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        .timer-section {
            text-align: center;
            margin-bottom: 15px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }

        .timer {
            font-size: 3rem;
            font-weight: 800;
            color: var(--danger);
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 15px;
            border: 3px solid var(--danger);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.3);
            min-width: 120px;
        }

        .seconds-label {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--light);
            background: rgba(0, 0, 0, 0.5);
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid var(--accent);
        }

        .word-display {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.4));
            border-radius: 15px;
            margin: 15px 0;
            border: 3px solid var(--accent);
            min-height: 180px;
            position: relative;
            overflow: hidden;
        }

        .word-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(253, 187, 45, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .word {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--accent);
            text-align: center;
            padding: 20px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7);
        }

        .word.hidden {
            color: transparent;
            text-shadow: none;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .start-btn {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
        }

        .stop-btn {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            color: white;
        }

        .next-btn {
            background: linear-gradient(135deg, var(--info), #2980b9);
            color: white;
        }

        .raddoppio-btn {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
        }

        .correct-btn {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
            padding: 10px 20px;
        }

        .wrong-btn {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            color: white;
            padding: 10px 20px;
        }

        .answer-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            align-items: center;
        }

        .hidden {
            display: none !important;
        }

        .round-info {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--accent);
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid var(--accent);
            font-weight: 600;
        }

        .stats-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .stat-box {
            text-align: center;
            background: rgba(0, 0, 0, 0.4);
            padding: 12px;
            border-radius: 10px;
            border: 2px solid var(--accent);
            min-width: 130px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--light);
            margin-bottom: 6px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--accent);
        }

        .results-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .results-content {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 40px;
            border-radius: 20px;
            border: 4px solid var(--accent);
            text-align: center;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
        }

        .results-title {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 30px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .results-points {
            font-size: 4rem;
            font-weight: 800;
            color: var(--success);
            margin: 20px 0;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
        }

        .money-input {
            margin: 30px 0;
        }

        .money-input input {
            padding: 15px;
            font-size: 1.5rem;
            border: none;
            border-radius: 10px;
            text-align: center;
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            font-weight: 600;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .money-input input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(253, 187, 45, 0.5);
            transform: scale(1.02);
        }

        .total-money {
            font-size: 2rem;
            color: var(--accent);
            margin: 25px 0;
            font-weight: 700;
        }

        .money-calculation {
            font-size: 1.2rem;
            color: var(--light);
            margin: 15px 0;
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .setup-screen {
            text-align: center;
            padding: 30px 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .team-setup {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .team-input {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            padding: 25px;
            border-radius: 15px;
            border: 2px solid var(--accent);
            width: 320px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }

        .team-input:hover {
            transform: translateY(-5px);
        }

        .team-input h3 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 700;
        }

        input {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.95);
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(253, 187, 45, 0.5);
            transform: scale(1.02);
        }

        .player-input {
            display: flex;
            gap: 10px;
            margin: 12px 0;
            align-items: center;
        }

        .add-player-btn {
            background: var(--info);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-player-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        .player-list {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 6px 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-list-item:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08));
            transform: translateX(3px);
        }

        .remove-player-btn {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-player-btn:hover {
            transform: scale(1.1);
        }

        .answering-player {
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 8px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
            border: 1px solid var(--accent);
        }

        @keyframes scoreAnimation {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .score-animation {
            animation: scoreAnimation 0.3s ease-in-out;
        }

        .menu-btn {
            background: linear-gradient(135deg, var(--info), #2980b9);
            color: white;
            margin-top: 15px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .game-layout {
                flex-direction: column;
                gap: 10px;
            }
            
            .team-sidebar {
                flex: 0 0 auto;
                min-height: 200px;
            }
            
            .team-setup {
                flex-direction: column;
                align-items: center;
            }
            
            .word {
                font-size: 2.5rem;
            }
            
            .timer {
                font-size: 2.5rem;
            }
            
            .seconds-label {
                font-size: 1.2rem;
            }
            
            .stats-container {
                gap: 10px;
            }
            
            .stat-box {
                min-width: 110px;
                padding: 10px;
            }
            
            .stat-label {
                font-size: 0.8rem;
            }
            
            .stat-value {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Schermata di Setup -->
    <div class="container setup-screen" id="setupScreen">
        <header>
            <h1>ðŸŽ¯ INTESA VINCENTE</h1>
            <p class="subtitle">3 passi per squadra - 2 raddoppi</p>
        </header>
        
        <div class="team-setup">
            <div class="team-input">
                <h3><i class="fas fa-users"></i> SQUADRA A</h3>
                <input type="text" id="teamAName" placeholder="Nome Squadra A" value="Squadra A">
                <div class="player-input">
                    <input type="text" id="teamAPlayerInput" placeholder="Nome giocatore">
                    <button class="add-player-btn" id="addTeamAPlayer"><i class="fas fa-plus"></i></button>
                </div>
                <div class="player-list" id="teamAPlayerList"></div>
            </div>
            
            <div class="team-input">
                <h3><i class="fas fa-users"></i> SQUADRA B</h3>
                <input type="text" id="teamBName" placeholder="Nome Squadra B" value="Squadra B">
                <div class="player-input">
                    <input type="text" id="teamBPlayerInput" placeholder="Nome giocatore">
                    <button class="add-player-btn" id="addTeamBPlayer"><i class="fas fa-plus"></i></button>
                </div>
                <div class="player-list" id="teamBPlayerList"></div>
            </div>
        </div>
        
        <button class="start-btn" id="startGameBtn" style="padding: 15px 30px; margin: 0 auto;">
            <i class="fas fa-play-circle"></i> INIZIA IL GIOCO
        </button>
    </div>

    <!-- Schermata di Gioco -->
    <div class="container hidden" id="gameScreen">
        <header>
            <h1>ðŸŽ¯ INTESA VINCENTE</h1>
            <div class="round-info" id="roundInfo">Squadra A - Passo 1 di 3</div>
        </header>
        
        <div class="game-layout">
            <!-- Squadra A -->
            <div class="team-sidebar" id="teamASidebar">
                <div class="team-name" id="displayTeamA"><i class="fas fa-users"></i> Squadra A</div>
                <div class="score" id="scoreA">0 Punti</div>
                <div class="players-list" id="teamAPlayersList"></div>
            </div>
            
            <!-- Area Centrale di Gioco -->
            <div class="game-center">
                <div class="timer-section">
                    <div class="timer-container">
                        <div class="timer" id="timer">60</div>
                        <div class="seconds-label">SECONDI</div>
                    </div>
                    <div class="stats-container" id="statsContainer">
                        <div class="stat-box">
                            <div class="stat-label">PASSI UTILIZZATI</div>
                            <div class="stat-value" id="passiUtilizzati">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">PASSI RESTANTI</div>
                            <div class="stat-value" id="passiRestanti">3</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">RADDOPPI UTILIZZATI</div>
                            <div class="stat-value" id="raddoppiUtilizzati">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">RADDOPPI RESTANTI</div>
                            <div class="stat-value" id="raddoppiRestanti">2</div>
                        </div>
                    </div>
                </div>
                
                <div class="word-display">
                    <div class="word hidden" id="currentWord">PAROLA</div>
                </div>
                
                <div class="controls">
                    <button class="start-btn" id="startTurnBtn">
                        <i class="fas fa-play"></i> INIZIA
                    </button>
                    <button class="stop-btn" id="stopTimerBtn" disabled>
                        <i class="fas fa-pause"></i> STOP
                    </button>
                    <button class="raddoppio-btn" id="raddoppioBtn" disabled>
                        <i class="fas fa-bolt"></i> RADDOPPIA
                    </button>
                    <button class="next-btn" id="passoBtn" disabled>
                        <i class="fas fa-forward"></i> PASSO
                    </button>
                </div>
                
                <div class="answer-controls hidden" id="answerControls">
                    <div class="answering-player" id="answeringPlayer">
                        <i class="fas fa-user"></i> Risponde: Squadra A
                    </div>
                    <div style="display: flex; gap: 15px;">
                        <button class="correct-btn" id="correctBtn">
                            <i class="fas fa-check"></i> ESATTA
                        </button>
                        <button class="wrong-btn" id="wrongBtn">
                            <i class="fas fa-times"></i> ERRATA
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Squadra B -->
            <div class="team-sidebar" id="teamBSidebar">
                <div class="team-name" id="displayTeamB"><i class="fas fa-users"></i> Squadra B</div>
                <div class="score" id="scoreB">0 Punti</div>
                <div class="players-list" id="teamBPlayersList"></div>
            </div>
        </div>
    </div>

    <!-- Schermata Risultati -->
    <div class="results-screen hidden" id="resultsScreen">
        <div class="results-content">
            <div class="results-title" id="resultsTitle"><i class="fas fa-trophy"></i> RISULTATI SQUADRA A</div>
            
            <div style="font-size: 1.3rem; margin-bottom: 20px;">
                Punti totalizzati in questo passo:
            </div>
            
            <div class="results-points" id="resultsPoints">0</div>
            
            <div class="money-input">
                <div style="font-size: 1.2rem; margin-bottom: 15px;">
                    <i class="fas fa-money-bill-wave"></i> Soldi accumulati prima:
                </div>
                <input type="number" id="previousMoney" placeholder="Inserisci importo in â‚¬" value="0">
            </div>
            
            <div class="money-calculation" id="moneyCalculation">
                <i class="fas fa-calculator"></i> Calcolo: 0 punti Ã— â‚¬2.000 = â‚¬0
            </div>
            
            <div class="total-money" id="totalMoney"><i class="fas fa-coins"></i> TOTALE: â‚¬0</div>
            
            <button class="start-btn" id="continueBtn" style="padding: 15px 40px; font-size: 1.2rem; margin-top: 20px;">
                <i class="fas fa-arrow-right"></i> AVANTI
            </button>
            
            <button class="menu-btn" id="menuBtn" style="padding: 12px 30px; font-size: 1.1rem; display: none;">
                <i class="fas fa-home"></i> TORNA AL MENU
            </button>
        </div>
    </div>

    <script>
        // Variabili globali
        let teamAPlayers = [];
        let teamBPlayers = [];
        let puntiA = 0;
        let puntiB = 0;
        let currentTeam = 'A';
        let currentPasso = 1;
        let totalPassi = 3;
        let passiUtilizzati = 0;
        let raddoppiUtilizzati = 0;
        let maxRaddoppi = 2;
        let timeLeft = 60;
        let timerInterval;
        let gameActive = false;
        let currentWordIndex = 0;
        let puntiTotalizzati = 0;
        let isRaddoppioAttivo = false;
        let raddoppioPerParola = false;
        let gameCompleted = false;
        let availableWords = [];
        let availableDoubleWords = [];

        // Database di parole - PAROLE SINGOLE
        const words = [
            "LAMPADINA", "TRENO", "PIZZA", "CANE", "OMBRELLO",
            "SOLDATO", "MARE", "COMPUTER", "DOTTORE", "LUNA",
            "MARTELLO", "CHITARRA", "SCUOLA", "BAMBINO", "CAFFÃˆ",
            "AEREO", "SCARPE", "GIARDINO", "LEONE", "TAVOLO",
            "GELATO", "TELEFONO", "OROLOGIO", "NUVOLA", "BIBLIOTECA",
            "CAVALLO", "SCIMMIA", "SPAZZOLINO", "FORNO", "CALCIO",
            "SPIAGGIA", "MURO", "ALBERO", "SALE", "PESCE",
            "BICICLETTA", "PANTALONI", "DINOSAURO", "PALESTRA", "RAGNO",
            "DENTISTA", "FINESTRA", "FIUME", "LAMPIONE", "ZAINO",
            "CUSCINO", "VENTO", "PORTA", "SEDIA", "TOPO",
            "CHIESA", "SABBIA", "SPECCHIO", "FIORE", "TIGRE",
            "CAMINO", "LATTE", "OCCHIALI", "SASSO", "VULCANO",
            "COCOMERO", "BOTTIGLIA", "CHIODO", "NEVE", "PIANOFORTE",
            "TELEVISORE", "LIBRO", "FARFALLA", "CANDELA", "CAVOLFIORE",
            "SCOPA", "TARTARUGA", "CIELO", "TRAMONTO", "PIPISTRELLO",
            "ZEBRA", "MACCHINA", "TAPPETO", "ZUCCHERO", "ARANCIA",
            "BICCHIERE", "SCARAFAGGIO", "APE", "MONTE", "RISTORANTE",
            "CAROTA", "TENDA", "SQUALO", "BANDIERA", "CORDA",
            "CIGNO", "VALIGIA", "TESCHIO", "MEDAGLIA", "PIUMA",
            "TORRE", "SERPENTE", "FERRO", "CUORE", "CARTA",
            "FUNGO"
        ];

        // Database di frasi doppie per i raddoppi
        const doublePhrases = [
            "CAVALLO MARINO", "CARTA IGIENICA", "TELEFONO FISSO", "ACQUA CALDA",
            "LETTO MATRIMONIALE", "OCCHIALI DA SOLE", "PORTA FINESTRA", "SPAZZOLINO DENTI",
            "ASCIUGA CAPELLI", "FRIGO BAR", "TRENO MERCI", "MACCHINA FOTOGRAFICA",
            "TAVOLO PRANZO", "BORSA TERMICA", "GIACCA VENTO", "AEREO LINEA",
            "CANE CACCIA", "PESCE SPADA", "POMODORO SECCO", "CAPPELLO SOLE",
            "FINESTRA APERTA", "SCATOLA NERA", "PUNTO LUCE", "OROLOGIO POLSO",
            "SCARPE GINNASTICA", "ZAINO MONTAGNA", "LETTERA AMORE", "SEDIA PIEGHEVOLE",
            "LAGO ARTIFICIALE", "MARE APERTO", "MANO DESTRA", "PIANETA TERRA",
            "LAMPADA TAVOLO", "PIUMONE MATRIMONIALE", "FERRO STIRO", "TORTA CIOCCOLATO",
            "MELA VERDE", "CANE LUPO", "FIUME PO", "SALE GROSSO",
            "PEPE NERO", "CARTA PARATI", "CALCIO ANGOLO", "BANDIERA ITALIANA",
            "SCARPA SINISTRA", "PIANO BAR", "LIBRO GIALLO", "BICCHIERE VINO",
            "TENDA CAMPEGGIO", "FINESTRA CHIUSA", "MACCHINA SCRIVERE", "RADIO PORTATILE",
            "FILO SPINATO", "CACCIAVITE CROCE", "CAPPOTTO LUNGO", "BUSTA PAGA",
            "TRENO ALTA", "AEREO CACCIA", "VINO ROSSO", "BIRRA ARTIGIANALE",
            "ACQUA MINERALE", "PANE INTEGRALE", "OLIO OLIVA", "ZUCCHERO VELO",
            "CAFFÃˆ MACCHIATO", "LATTE CALDO", "UOVO SODO", "FORMAGGIO STAGIONATO",
            "CAVOLO CAPPUCCIO", "PATATA FRITTA", "PESCE ROSSO", "LAMPIONE STRADA",
            "SCUOLA ELEMENTARE", "CASA EDITRICE", "CINEMA APERTO", "TEATRO COMUNALE",
            "CENTRO COMMERCIALE", "CAMPO CALCIO", "STADIO OLIMPICO", "AUTO EPOCA",
            "CAMICIA BIANCA", "PANTALONE CORTO", "GONNA LUNGA", "SCARPA TACCO",
            "ZAINO SCOLASTICO", "PORTAFOGLIO VUOTO", "SPECCHIO RETROVISORE", "CHIAVE INGLESE",
            "TAPPETO ROSSO", "DIVANO LETTO", "CUSCINO DECORATIVO", "QUADRO MODERNO",
            "CORNICE DORATA", "LIBRERIA MURO", "TELEFONO CELLULARE", "COMPUTER PORTATILE",
            "MOUSE WIRELESS", "STAMPANTE LASER", "BOTTIGLIA ACQUA", "BIGLIETTO VISITA",
            "PORTA CHIAVI"
        ];

        // Elementi DOM
        const setupScreen = document.getElementById('setupScreen');
        const gameScreen = document.getElementById('gameScreen');
        const resultsScreen = document.getElementById('resultsScreen');
        const timerDisplay = document.getElementById('timer');
        const currentWordDisplay = document.getElementById('currentWord');
        const roundInfo = document.getElementById('roundInfo');
        const previousMoneyInput = document.getElementById('previousMoney');
        const resultsPoints = document.getElementById('resultsPoints');
        const resultsTitle = document.getElementById('resultsTitle');
        const totalMoney = document.getElementById('totalMoney');
        const moneyCalculation = document.getElementById('moneyCalculation');
        const continueBtn = document.getElementById('continueBtn');
        const menuBtn = document.getElementById('menuBtn');

        // Setup giocatori
        document.getElementById('addTeamAPlayer').addEventListener('click', () => addPlayer('A'));
        document.getElementById('addTeamBPlayer').addEventListener('click', () => addPlayer('B'));
        document.getElementById('startGameBtn').addEventListener('click', startGame);
        continueBtn.addEventListener('click', continueToNext);
        menuBtn.addEventListener('click', returnToMenu);

        function addPlayer(team) {
            const input = document.getElementById(`team${team}PlayerInput`);
            const list = document.getElementById(`team${team}PlayerList`);
            const playerName = input.value.trim();
            
            if (playerName) {
                const players = team === 'A' ? teamAPlayers : teamBPlayers;
                players.push(playerName);
                updatePlayerList(team);
                input.value = '';
            }
        }

        function removePlayer(team, index) {
            const players = team === 'A' ? teamAPlayers : teamBPlayers;
            players.splice(index, 1);
            updatePlayerList(team);
        }

        function updatePlayerList(team) {
            const list = document.getElementById(`team${team}PlayerList`);
            const players = team === 'A' ? teamAPlayers : teamBPlayers;
            
            list.innerHTML = '';
            players.forEach((player, index) => {
                const playerItem = document.createElement('div');
                playerItem.className = 'player-list-item';
                playerItem.innerHTML = `
                    <span><i class="fas fa-user"></i> ${player}</span>
                    <button class="remove-player-btn" onclick="removePlayer('${team}', ${index})"><i class="fas fa-times"></i></button>
                `;
                list.appendChild(playerItem);
            });
        }

        function startGame() {
            // Aggiorna nomi squadre
            document.getElementById('displayTeamA').textContent = document.getElementById('teamAName').value;
            document.getElementById('displayTeamB').textContent = document.getElementById('teamBName').value;
            
            // Aggiorna liste giocatori
            updatePlayersInSidebars();
            
            // Passa alla schermata di gioco
            setupScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            // Inizializza il gioco
            initGame();
        }

        function updatePlayersInSidebars() {
            updatePlayersInSidebar('teamAPlayersList', teamAPlayers);
            updatePlayersInSidebar('teamBPlayersList', teamBPlayers);
        }

        function updatePlayersInSidebar(elementId, players) {
            const element = document.getElementById(elementId);
            element.innerHTML = '';
            players.forEach(player => {
                const playerItem = document.createElement('div');
                playerItem.className = 'player-item';
                playerItem.innerHTML = `<i class="fas fa-user"></i> ${player}`;
                element.appendChild(playerItem);
            });
        }

        function initGame() {
            // Mescola le parole all'inizio del gioco
            shuffleWords();
            
            updatePunti();
            updateActiveTeam();
            updateRoundInfo();
            updateStats();
            currentWordDisplay.classList.add('hidden');
            puntiTotalizzati = 0;
            isRaddoppioAttivo = false;
            raddoppioPerParola = false;
            gameCompleted = false;
        }

        function shuffleWords() {
            // Mescola le parole singole
            availableWords = [...words];
            for (let i = availableWords.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [availableWords[i], availableWords[j]] = [availableWords[j], availableWords[i]];
            }
            
            // Mescola le parole doppie
            availableDoubleWords = [...doublePhrases];
            for (let i = availableDoubleWords.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [availableDoubleWords[i], availableDoubleWords[j]] = [availableDoubleWords[j], availableDoubleWords[i]];
            }
            
            currentWordIndex = 0;
        }

        function updateActiveTeam() {
            document.getElementById('teamASidebar').classList.remove('active');
            document.getElementById('teamBSidebar').classList.remove('active');
            
            if (currentTeam === 'A') {
                document.getElementById('teamASidebar').classList.add('active');
            } else {
                document.getElementById('teamBSidebar').classList.add('active');
            }
            
            document.getElementById('answeringPlayer').innerHTML = `<i class="fas fa-user"></i> Risponde: ${currentTeam === 'A' ? document.getElementById('displayTeamA').textContent : document.getElementById('displayTeamB').textContent}`;
        }

        function updatePunti() {
            document.getElementById('scoreA').textContent = `${puntiA} Punti`;
            document.getElementById('scoreB').textContent = `${puntiB} Punti`;
        }

        function updateRoundInfo() {
            const teamName = currentTeam === 'A' ? document.getElementById('displayTeamA').textContent : document.getElementById('displayTeamB').textContent;
            const raddoppioText = isRaddoppioAttivo ? " - RADDOPPIO ATTIVO!" : "";
            roundInfo.textContent = `${teamName} - Passo ${currentPasso} di ${totalPassi}${raddoppioText}`;
        }

        function updateStats() {
            document.getElementById('passiUtilizzati').textContent = passiUtilizzati;
            document.getElementById('passiRestanti').textContent = Math.max(0, 3 - passiUtilizzati);
            document.getElementById('raddoppiUtilizzati').textContent = raddoppiUtilizzati;
            document.getElementById('raddoppiRestanti').textContent = Math.max(0, maxRaddoppi - raddoppiUtilizzati);
        }

        function showNextWord() {
            if (isRaddoppioAttivo && raddoppioPerParola && currentWordIndex < availableDoubleWords.length) {
                currentWordDisplay.textContent = availableDoubleWords[currentWordIndex];
            } else if (currentWordIndex < availableWords.length) {
                currentWordDisplay.textContent = availableWords[currentWordIndex];
            } else {
                currentWordDisplay.textContent = "FINE PAROLE";
                endTurn();
                return;
            }
            
            currentWordDisplay.classList.remove('hidden');
            currentWordIndex++;
        }

        // Controlli di gioco
        document.getElementById('startTurnBtn').addEventListener('click', startTurn);
        document.getElementById('stopTimerBtn').addEventListener('click', stopTimer);
        document.getElementById('raddoppioBtn').addEventListener('click', attivaRaddoppio);
        document.getElementById('passoBtn').addEventListener('click', usaPasso);
        document.getElementById('correctBtn').addEventListener('click', handleCorrectAnswer);
        document.getElementById('wrongBtn').addEventListener('click', handleWrongAnswer);

        function startTurn() {
            if (gameActive) return;
            
            gameActive = true;
            timeLeft = 60;
            timerDisplay.textContent = timeLeft;
            currentWordIndex = 0;
            puntiTotalizzati = 0;
            isRaddoppioAttivo = false;
            raddoppioPerParola = false;
            
            document.getElementById('startTurnBtn').disabled = true;
            document.getElementById('stopTimerBtn').disabled = false;
            document.getElementById('raddoppioBtn').disabled = false;
            document.getElementById('passoBtn').disabled = false;
            document.getElementById('answerControls').classList.add('hidden');
            
            updateRoundInfo();
            showNextWord();
            startTimer();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endTurn();
                }
            }, 1000);
        }

        function stopTimer() {
            if (!gameActive) return;
            
            clearInterval(timerInterval);
            document.getElementById('answerControls').classList.remove('hidden');
            document.getElementById('stopTimerBtn').disabled = true;
            document.getElementById('raddoppioBtn').disabled = true;
            document.getElementById('passoBtn').disabled = true;
        }

        function attivaRaddoppio() {
            if (!gameActive || isRaddoppioAttivo || raddoppiUtilizzati >= maxRaddoppi) return;
            
            isRaddoppioAttivo = true;
            raddoppioPerParola = true;
            raddoppiUtilizzati++;
            document.getElementById('raddoppioBtn').disabled = true;
            document.getElementById('raddoppioBtn').innerHTML = '<i class="fas fa-bolt"></i> RADDOPPIO ATTIVO';
            updateRoundInfo();
            updateStats();
            
            // Mostra subito una parola doppia
            showNextWord();
        }

        function usaPasso() {
            if (!gameActive || passiUtilizzati >= 3) return;
            
            passiUtilizzati++;
            updateStats();
            
            // Se abbiamo usato tutti e 3 i passi, disabilita il pulsante
            if (passiUtilizzati >= 3) {
                document.getElementById('passoBtn').disabled = true;
            }
            
            // Passa alla parola successiva
            showNextWord();
        }

        function handleCorrectAnswer() {
            const punti = isRaddoppioAttivo && raddoppioPerParola ? 2 : 1;
            puntiTotalizzati += punti;
            
            if (currentTeam === 'A') {
                puntiA += punti;
            } else {
                puntiB += punti;
            }
            
            // Disattiva il raddoppio dopo una risposta corretta
            if (isRaddoppioAttivo && raddoppioPerParola) {
                isRaddoppioAttivo = false;
                raddoppioPerParola = false;
                document.getElementById('raddoppioBtn').innerHTML = '<i class="fas fa-bolt"></i> RADDOPPIA';
                updateRoundInfo();
            }
            
            updatePunti();
            animateScore(currentTeam);
            document.getElementById('answerControls').classList.add('hidden');
            document.getElementById('stopTimerBtn').disabled = false;
            document.getElementById('raddoppioBtn').disabled = false;
            document.getElementById('passoBtn').disabled = false;
            
            showNextWord();
            startTimer();
        }

        function handleWrongAnswer() {
            const punti = isRaddoppioAttivo && raddoppioPerParola ? 2 : 1;
            
            // Non si puÃ² andare sotto lo 0
            if (currentTeam === 'A' && puntiA >= punti) {
                puntiA -= punti;
                puntiTotalizzati -= punti;
            } else if (currentTeam === 'B' && puntiB >= punti) {
                puntiB -= punti;
                puntiTotalizzati -= punti;
            }
            
            // Disattiva il raddoppio dopo una risposta errata
            if (isRaddoppioAttivo && raddoppioPerParola) {
                isRaddoppioAttivo = false;
                raddoppioPerParola = false;
                document.getElementById('raddoppioBtn').innerHTML = '<i class="fas fa-bolt"></i> RADDOPPIA';
                updateRoundInfo();
            }
            
            updatePunti();
            animateScore(currentTeam);
            document.getElementById('answerControls').classList.add('hidden');
            document.getElementById('stopTimerBtn').disabled = false;
            document.getElementById('raddoppioBtn').disabled = false;
            document.getElementById('passoBtn').disabled = false;
            
            showNextWord();
            startTimer();
        }

        function animateScore(team) {
            const scoreElement = document.getElementById(team === 'A' ? 'scoreA' : 'scoreB');
            scoreElement.classList.add('score-animation');
            setTimeout(() => {
                scoreElement.classList.remove('score-animation');
            }, 300);
        }

        function endTurn() {
            clearInterval(timerInterval);
            gameActive = false;
            
            document.getElementById('startTurnBtn').disabled = false;
            document.getElementById('stopTimerBtn').disabled = true;
            document.getElementById('raddoppioBtn').disabled = true;
            document.getElementById('passoBtn').disabled = true;
            document.getElementById('answerControls').classList.add('hidden');
            currentWordDisplay.classList.add('hidden');
            
            // Mostra schermata risultati
            showResults();
        }

        function showResults() {
            const teamName = currentTeam === 'A' ? document.getElementById('displayTeamA').textContent : document.getElementById('displayTeamB').textContent;
            resultsTitle.textContent = `RISULTATI ${teamName}`;
            resultsPoints.textContent = puntiTotalizzati;
            
            // Calcola i soldi precedenti in base ai punti
            const soldiPrecedenti = (currentTeam === 'A' ? puntiA - puntiTotalizzati : puntiB - puntiTotalizzati) * 2000;
            previousMoneyInput.value = soldiPrecedenti;
            
            updateTotalMoney();
            
            // Controlla se il gioco Ã¨ completato (entrambe le squadre hanno finito i 3 passi)
            if (currentTeam === 'B' && currentPasso >= totalPassi) {
                gameCompleted = true;
                continueBtn.style.display = 'none';
                menuBtn.style.display = 'block';
                resultsTitle.innerHTML = `<i class="fas fa-flag-checkered"></i> GIOCO COMPLETATO`;
            } else {
                continueBtn.style.display = 'block';
                menuBtn.style.display = 'none';
            }
            
            gameScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');
        }

        function updateTotalMoney() {
            const previousMoney = parseInt(previousMoneyInput.value) || 0;
            const newMoney = puntiTotalizzati * 2000;
            const total = previousMoney + newMoney;
            
            moneyCalculation.textContent = `Calcolo: ${puntiTotalizzati} punti Ã— â‚¬2.000 = â‚¬${newMoney.toLocaleString()}`;
            totalMoney.textContent = `TOTALE: â‚¬${total.toLocaleString()}`;
        }

        function continueToNext() {
            // Aggiorna i punti della squadra
            const previousMoney = parseInt(previousMoneyInput.value) || 0;
            const newMoney = puntiTotalizzati * 2000;
            const totalPunti = (previousMoney / 2000) + puntiTotalizzati;
            
            if (currentTeam === 'A') {
                puntiA = totalPunti;
            } else {
                puntiB = totalPunti;
            }
            
            // Passa al passo successivo o cambia squadra
            currentPasso++;
            
            if (currentPasso > totalPassi) {
                // Cambia squadra
                currentTeam = currentTeam === 'A' ? 'B' : 'A';
                currentPasso = 1;
                // Resetta i contatori per la nuova squadra
                passiUtilizzati = 0;
                raddoppiUtilizzati = 0;
                // Mescola di nuovo le parole per il nuovo turno
                shuffleWords();
            }
            
            // Torna alla schermata di gioco
            resultsScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            // Aggiorna l'interfaccia
            updatePunti();
            updateActiveTeam();
            updateRoundInfo();
            updateStats();
            
            // Aggiorna il testo del pulsante start
            const teamName = currentTeam === 'A' ? document.getElementById('displayTeamA').textContent : document.getElementById('displayTeamB').textContent;
            document.getElementById('startTurnBtn').innerHTML = `<i class="fas fa-play"></i> TOCCA A ${teamName.toUpperCase()} - INIZIA`;
        }

        function returnToMenu() {
            // Torna alla schermata iniziale
            resultsScreen.classList.add('hidden');
            setupScreen.classList.remove('hidden');
            
            // Resetta il gioco
            puntiA = 0;
            puntiB = 0;
            currentTeam = 'A';
            currentPasso = 1;
            passiUtilizzati = 0;
            raddoppiUtilizzati = 0;
            gameCompleted = false;
        }

        // Aggiorna totale quando cambia l'input
        previousMoneyInput.addEventListener('input', updateTotalMoney);

        // Inizializzazione
        window.addEventListener('load', () => {
            updatePlayerList('A');
            updatePlayerList('B');
        });
    </script>
</body>
</html>
